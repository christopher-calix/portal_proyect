{% extends 'base.html' %}
{% block title %}Lista de comprobantes{% endblock %}
{% load staticfiles %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/datatables/dataTables.bootstrap.min.css' %}">
<link rel="stylesheet" href="{% static 'css/datatables/responsive.bootstrap.min.css' %}">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.0/sweetalert.min.css">
<link rel="stylesheet" href="{% static 'css/bootstrap-datetimepicker.css' %}">
<link href="{% static 'css/select-input/bootstrap-select.css' %}" media="all" rel="stylesheet" type="text/css" />
<link href="{% static 'css/jquery.toast.css' %}" rel="stylesheet" />
<link href="{% static 'css/history/core/history.css' %}" rel="stylesheet" />
<style type="text/css">
    .text-muted {
        color: #2b2b2b;
        font-weight: initial;
    }
</style>
{% endblock %}
{% block js %}

<script src="{% static 'js/datatables/jquery.dataTables.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/datatables/dataTables.bootstrap.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/datatables/dataTables.responsive.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/datatables/dataTables.select.min.js' %}" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.0/sweetalert.min.js" type="text/javascript"></script>
<script src="{% static 'js/moment-with-locales.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/bootstrap-datetimepicker.min.js' %}" type="text/javascript"></script>

<script src="{% static 'js/core/providers/invoices.js' %}?ver=2" type="text/javascript"></script>
<script src="{% static 'js/select-input/bootstrap-select.js' %}" type="text/javascript"></script>
<script src="{% static 'js/jquery.toast.js' %}" type="text/javascript" ></script>


<script type="text/javascript">
//sketch lib
(function () {
    var __slice = [].slice;

    (function ($) {
        var Sketch;
        $.fn.sketch = function () {
            var args, key, sketch;
            key = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
            if (this.length > 1) {
                $.error('Sketch.js can only be called on one element at a time.');
            }
            sketch = this.data('sketch');
            if (typeof key === 'string' && sketch) {
                if (sketch[key]) {
                    if (typeof sketch[key] === 'function') {
                        return sketch[key].apply(sketch, args);
                    } else if (args.length === 0) {
                        return sketch[key];
                    } else if (args.length === 1) {
                        return sketch[key] = args[0];
                    }
                } else {
                    return $.error('Sketch.js did not recognize the given command.');
                }
            } else if (sketch) {
                return sketch;
            } else {
                this.data('sketch', new Sketch(this.get(0), key));
                return this;
            }
        };
        Sketch = (function () {

            function Sketch(el, opts) {
                this.el = el;
                this.canvas = $(el);
                this.context = el.getContext('2d');
                this.options = $.extend({
                    toolLinks: true,
                    defaultTool: 'marker',
                    defaultColor: '#000000',
                    defaultSize: 2
                }, opts);
                this.painting = false;
                this.color = this.options.defaultColor;
                this.size = this.options.defaultSize;
                this.tool = this.options.defaultTool;
                this.actions = [];
                this.action = [];
                this.canvas.bind('click mousedown mouseup mousemove mouseleave mouseout touchstart touchmove touchend touchcancel', this.onEvent);
                if (this.options.toolLinks) {
                    $('body').delegate("a[href=\"#" + (this.canvas.attr('id')) + "\"]", 'click', function (e) {
                        var $canvas, $this, key, sketch, _i, _len, _ref;
                        $this = $(this);
                        $canvas = $($this.attr('href'));
                        sketch = $canvas.data('sketch');
                        _ref = ['color', 'size', 'tool'];
                        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                            key = _ref[_i];
                            if ($this.attr("data-" + key)) {
                                sketch.set(key, $(this).attr("data-" + key));
                            }
                        }
                        if ($(this).attr('data-download')) {
                            sketch.download($(this).attr('data-download'));
                        }
                        return false;
                    });
                }
            }

            Sketch.prototype.download = function (format) {
                var mime;
                format || (format = "png");
                if (format === "jpg") {
                    format = "jpeg";
                }
                mime = "image/" + format;
                return window.open(this.el.toDataURL(mime));
            };

            Sketch.prototype.set = function (key, value) {
                this[key] = value;
                return this.canvas.trigger("sketch.change" + key, value);
            };

            Sketch.prototype.startPainting = function () {
                this.painting = true;
                return this.action = {
                    tool: this.tool,
                    color: this.color,
                    size: parseFloat(this.size),
                    events: []
                };
            };


            Sketch.prototype.stopPainting = function () {
                if (this.action) {
                    this.actions.push(this.action);
                }
                this.painting = false;
                this.action = null;
                return this.redraw();
            };

            Sketch.prototype.onEvent = function (e) {
                if (e.originalEvent && e.originalEvent.targetTouches) {
                    e.pageX = e.originalEvent.targetTouches[0].pageX;
                    e.pageY = e.originalEvent.targetTouches[0].pageY;
                }
                $.sketch.tools[$(this).data('sketch').tool].onEvent.call($(this).data('sketch'), e);
                e.preventDefault();
                return false;
            };

            Sketch.prototype.redraw = function () {
                var sketch;
                //this.el.width = this.canvas.width();
                this.context = this.el.getContext('2d');
                sketch = this;
                $.each(this.actions, function () {
                    if (this.tool) {
                        return $.sketch.tools[this.tool].draw.call(sketch, this);
                    }
                });
                if (this.painting && this.action) {
                    return $.sketch.tools[this.action.tool].draw.call(sketch, this.action);
                }
            };

            return Sketch;

        })();
        $.sketch = {
            tools: {}
        };
        $.sketch.tools.marker = {
            onEvent: function (e) {
                switch (e.type) {
                    case 'mousedown':
                    case 'touchstart':
                        if (this.painting) {
                            this.stopPainting();
                        }
                        this.startPainting();
                        break;
                    case 'mouseup':
                        //return this.context.globalCompositeOperation = oldcomposite;
                    case 'mouseout':
                    case 'mouseleave':
                    case 'touchend':
                        //this.stopPainting();
                    case 'touchcancel':
                        this.stopPainting();
                }
                if (this.painting) {
                    this.action.events.push({
                        x: e.pageX - this.canvas.offset().left,
                        y: e.pageY - this.canvas.offset().top,
                        event: e.type
                    });
                    return this.redraw();
                }
            },
            draw: function (action) {
                var event, previous, _i, _len, _ref;
                this.context.lineJoin = "round";
                this.context.lineCap = "round";
                this.context.beginPath();
                this.context.moveTo(action.events[0].x, action.events[0].y);
                _ref = action.events;
                for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                    event = _ref[_i];
                    this.context.lineTo(event.x, event.y);
                    previous = event;
                }
                this.context.strokeStyle = action.color;
                this.context.lineWidth = action.size;
                return this.context.stroke();
            }
        };
        return $.sketch.tools.eraser = {
            onEvent: function (e) {
                return $.sketch.tools.marker.onEvent.call(this, e);
            },
            draw: function (action) {
                var oldcomposite;
                oldcomposite = this.context.globalCompositeOperation;
                this.context.globalCompositeOperation = "destination-out";
                action.color = "rgba(0,0,0,1)";
                $.sketch.tools.marker.draw.call(this, action);
                return this.context.globalCompositeOperation = oldcomposite;
            }
        };
    })(jQuery);

}).call(this);


(function ($) {
    $.fn.SignaturePad = function (options) {

        //update the settings
        var settings = $.extend({
            allowToSign: true,
            img64: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',
            border: '1px solid #c7c8c9',
            width: '300px',
            height: '150px',
            callback: function () {
                return true;
            }
        }, options);

        //control should be a textbox
        //loop all the controls
        var id = 0;

        //add a very big pad
        var big_pad = $('#signPadBig');
        var back_drop = $('#signPadBigBackDrop');
        var canvas = undefined;
        if (big_pad.length == 0) {

            back_drop = $('<div>')
            back_drop.css('position', 'fixed');
            back_drop.css('top', '0');
            back_drop.css('right', '0');
            back_drop.css('bottom', '0');
            back_drop.css('left', '0');
            back_drop.css('z-index', '1040 !important');
            back_drop.css('background-color', '#000');
            back_drop.css('display', 'none');
            back_drop.css('filter', 'alpha(opacity=50)');
            back_drop.css('opacity', '0.5');
            $('body').append(back_drop);

            big_pad = $('<div>');
            big_pad.css('display', 'none');
            big_pad.css('position', 'fixed');
            big_pad.css('margin', '0 auto');
            big_pad.css('top', '0');
            big_pad.css('bottom', '0');
            big_pad.css('right', '0');
            big_pad.css('left', '0');
            big_pad.css('z-index', '2000');
            big_pad.css('overflow', 'hidden');
            big_pad.css('outline', '0');
            big_pad.css('-webkit-overflow-scrolling', 'touch');

            big_pad.css('right', '0');
            big_pad.css('border', '1px solid #c8c8c8');
            big_pad.css('padding', '15px');
            big_pad.css('background-color', 'white');
            big_pad.css('margin-top', '1%');
            big_pad.css('width', '55%');
            big_pad.css('height', '50%');
            big_pad.css('border-radius', '10px');
            big_pad.attr('id', 'signPadBig');
            $('body').append(big_pad);

            var update_canvas_size = function () {
                var w = big_pad.width() //* 0.95;
                var h = big_pad.height() - 55;

                canvas.attr('width', w);
                canvas.attr('height', h);
            }


            canvas = $('<canvas>');
            canvas.css('display', 'block');
            canvas.css('margin', '0 auto');
            canvas.css('border', '1px solid #c8c8c8');
            canvas.css('border-radius', '10px');
            //canvas.css('width', '90%');
            //canvas.css('height', '80%');
            big_pad.append(canvas);

            update_canvas_size();
            $(window).on('resize', function () {
                update_canvas_size();
            });

            var clearCanvas = function () {
                canvas.sketch().action = null;
                canvas.sketch().actions = [];       // this line empties the actions. 
                var ctx = canvas[0].getContext("2d");
                ctx.clearRect(0, 0, canvas[0].width, canvas[0].height);
                return true
            }

            var _get_base64_value = function () {
                var text_control = $.data(big_pad[0], 'control');  //settings.control; // $('#' + big_pad.attr('id'));
                return $(text_control).val();
            }

            var copyCanvas = function () {
                //get data from bigger pad
                var sigData = canvas[0].toDataURL("image/png");

                var _img = new Image;
                _img.onload = resizeImage;
                _img.src = sigData;

                var targetWidth = canvas.width();
                var targetHeight = canvas.height();

                function resizeImage() {
                    var imageToDataUri = function (img, width, height) {

                        // create an off-screen canvas
                        var canvas = document.createElement('canvas'),
                            ctx = canvas.getContext('2d');

                        // set its dimension to target size
                        canvas.width = width;
                        canvas.height = height;

                        // draw source image into the off-screen canvas:
                        ctx.drawImage(img, 0, 0, width, height);

                        // encode image to data-uri with base64 version of compressed image
                        return canvas.toDataURL();
                    }

                    var newDataUri = imageToDataUri(this, targetWidth, targetHeight);
                    var control_img = $.data(big_pad[0], 'img');
                    if (control_img)
                        $(control_img).attr("src", newDataUri);

                    var text_control = $.data(big_pad[0], 'control');  //settings.control; // $('#' + big_pad.attr('id'));
                    if (text_control)
                        $(text_control).val(newDataUri);
                }
            }

            var buttons = [
                 {
                     title: 'Cerrar',
                     callback: function () {
                         clearCanvas();
                         big_pad.slideToggle(function () {
                             back_drop.hide('fade');
                         });

                     }
                 },
                 {
                     title: 'Borrar',
                     callback: function () {
                         clearCanvas();
                         if (settings.callback)
                             settings.callback(_get_base64_value(), 'Borrar');
                     }
                 },
                 {
                     title: 'Aceptar',
                     callback: function () {
                         copyCanvas();
                         clearCanvas();
                         big_pad.slideToggle(function () {
                             back_drop.hide('fade', function () {
                                 if (settings.callback)
                                     settings.callback(_get_base64_value(), 'Acceptar');
                             });
                         });
                     }
                 }].forEach(function (e) {
                     var btn = $('<button>');
                     btn.attr('type', 'button');
                     btn.css('border', '1px solid #c8c8c8');
                     btn.css('background-color', 'white');
                     btn.css('padding', '10px');
                     btn.css('display', 'block');
                     btn.css('margin-top', '15px');
                     btn.css('margin-right', '5px');
                     btn.css('cursor', 'pointer');
                     btn.css('border-radius', '5px');
                     btn.css('float', 'right');
                     btn.css('height', '40px');
                     btn.text(e.title);
                     btn.on('click', function () {
                         e.callback(e.title);
                     })
                     big_pad.append(btn);

                 });

        }
        else {
            canvas = big_pad.find('canvas')[0];
        }

        //init the signpad
        if (canvas) {
            var sign1big = $(canvas).sketch({ defaultColor: "#000", defaultSize: 5 });
        }

        //for each control
        return this.each(function () {

            var control = $(this);
            control.hide();

            //get the control parent
            var wrapper = control.parent();
            var img = $('<img>');

            //style it
            img.css("cursor", "pointer");
            img.css("border", settings.border);
            img.css("height", settings.height);
            img.css("width", settings.width);
            img.css('border-radius', '5px')
            img.attr("src", settings.img64);

            if (typeof (wrapper) == 'object') {
                wrapper.append(img);
            }




            //init the big sign pad
            if (settings.allowToSign == true) {
                //click to the pad bigger
                img.on('click', function () {
                    //show the pad
                    back_drop.show();
                    big_pad.slideToggle();

                    //save control to use later
                    $.data(big_pad[0], 'img', img);
                    $.data(big_pad[0], 'control', control);

                    //settings.control = control;
                    //settings.img = img;
                });
            }
        });
    };


})(jQuery);



</script>

<script >
  var CSRF_TOKEN = '{{ csrf_token }}';
  var tipo = '{{ type }}';
</script>
<script>
$(document).ready(function(){
    $('[data-toggle="popover"]').popover();   
});
</script>
{% endblock %}
{% block icon_main %}icon_document_alt{% endblock %}
{% block title_main %}Comprobantes{% endblock %}
{% block tree %}
<li><a href="{% url 'list_invoices' %}">Comprobantes</a></li>
{% endblock %}
{% block menu %}{% endblock %}
{% block content %}
<div class="row">
    <div class="col-lg-12">
        <section class="panel panel-default">
            <header class="panel-heading">
                Filtrado:
            </header>
            <div class="panel-body">
                <fieldset>
                    <dl class="col-lg-2">
                        <dt>Serie</dt>
                        <input type="text" id="filter_serie" name="uuid" class="form-control" placeholder="Serie">
                    </dl>
                    <dl class="col-lg-2">
                        <dt>Folio</dt>
                        <input type="text" id="filter_folio" name="uuid" class="form-control" placeholder="Folio">
                    </dl>
                    <dl class="col-lg-3">
                        <dt>Nombre Archivo</dt>
                        <input type="text" id="filter_filename" name="filename" class="form-control" placeholder="Nombre del Archivo">
                    </dl>
                    <dl class="col-lg-3">
                        <dt>UUID</dt>
                        <input type="text" id="filter_uuid" name="uuid" class="form-control" placeholder="UUID">
                    </dl>
                    <dl class="{% if request.user.role == 'E' %}col-lg-3{% else %}col-lg-2{% endif %}">
                        <dt>ESTATUS</dt>
                        <dd class="fields">
                            <select id="estado_sat" class="selectpicker form-control" data-hide-disabled="true" data-live-search="true">
                                <optgroup label="Estatus">
                                    <option value="A">Todos</option>
                                    <option value="S">Timbrados</option>
                                    <option value="C">Canceladas</option>
                                    {% if user.role != 'E' %}
                                        <option value="P">En Proceso</option>
                                        <option value="E">Error</option>
                                    {% endif %}
                                </optgroup>
                            </select>
                        </dd>
                    </dl>
                    {% if user.role in "SA" %}
                    {% comment %}
                        <dl class="col-lg-3">
                            <dt>RFC Emisor</dt>
                            <input type="text" id="filter_taxpayer_e" name="taxpayer_e" class="form-control" placeholder="RFC Emisor">
                        </dl>
                    {% endcomment %}
                    <dl class="col-lg-2">
                        <dt>Empresa</dt>
                        <input type="text" id="filter_business_id" name="business_id" class="form-control" placeholder="ID Empresa">
                    </dl>
                    <dl class="col-lg-3">
                        <dt>RFC Receptor</dt>
                        <input type="text" id="filter_taxpayer" name="taxpayer" class="form-control" placeholder="RFC Receptor">
                    </dl>
                    {% elif user.role == "B" %}
                    <dl class="col-lg-3">
                        <dt>RFC Receptor</dt>
                        <input type="text" id="filter_taxpayer" name="taxpayer" class="form-control" placeholder="RFC Receptor">
                    </dl>
                    {% endif %}
                    {% if user.role != "E" %}
                    <dl class="col-lg-4">
                        <dt>Nombre Receptor</dt>
                        <input type="text" id="filter_name" name="name" class="form-control" placeholder="Nombre Receptor">
                    </dl>
                    {% endif %}
                    <dl class="{% if request.user.role == 'E' %}col-lg-3{% else %}col-lg-2{% endif %}">
                        <dt>NOMINAS</dt>
                        <dd class="fields">
                            <select id="signed_payroll" class="selectpicker form-control" data-hide-disabled="true" data-live-search="true">
                                <optgroup label="Tipo de nomina">
                                    <option value="A">Todas</option>
                                    <option value="S">Firmadas</option>
                                    <option value="E">Sin Firmar</option>
                                </optgroup>
                            </select>
                        </dd>
                    </dl>
                    {% if user.role != "E" %}
                        <dl class="col-lg-2">
                            <dt>Fecha Inicio (Emisión)</dt>
                            <dd class="fields">
                                <div class="input-group date" id="date-from">
                                    <input type='text' class="form-control" id="date-from-res" placeholder="Fecha Inicial"/>
                                    <span class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </span>
                                </div>
                            </dd>
                        </dl>
                        <dl class="col-lg-2">
                            <dt>Fecha Fin (Emisión)</dt>
                            <dd class="fields">
                                <div class="input-group date" id="date-to">
                                    <input type='text' class="form-control" id="date-to-res" placeholder="Fecha Final"/>
                                    <span class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </span>
                                </div>
                            </dd>
                        </dl>
                    {% endif %}
                    <dl class="col-lg-2">
                        <dt>Fecha Inicial Pago</dt>
                        <dd class="fields">
                            <div class="input-group date" id="date-from-paid">
                                <input type='text' class="form-control" id="date-from-paid-res" placeholder="Fecha Inicial Pago"/>
                                <span class="input-group-addon">
                                    <i class="fa fa-calendar"></i>
                                </span>
                            </div>
                        </dd>
                    </dl>
                    <dl class="col-lg-2">
                        <dt>Fecha Final Pago</dt>
                        <dd class="fields">
                            <div class="input-group date" id="date-to-paid">
                                <input type='text' class="form-control" id="date-to-paid-res" placeholder="Fecha Final Pago"/>
                                <span class="input-group-addon">
                                    <i class="fa fa-calendar"></i>
                                </span>
                            </div>
                        </dd>
                    </dl>
                    {% comment %} 
                    <dl class="{% if request.user.role == 'E' %}col-lg-3{% else %}col-lg-2{% endif %}">
                        <dt>TIPO DE NOMINA</dt>
                        <dd class="fields">
                            <select id="nomina_type" class="selectpicker form-control" data-hide-disabled="true" data-live-search="true">
                                <optgroup label="Tipo de nomina">
                                    <option value="A">Todos</option>
                                    <option value="O">Ordinaria</option>
                                    <option value="E">Extraordinaria</option>
                                </optgroup>
                            </select>
                        </dd>
                    </dl>
                    {% endcomment %} 
                    <dl class="col-lg-2">
                        <dt>Limpiar</dt>
                        <dd class="fields">
                            <button type="button" id="clean" class="form-control btn-danger" title="Limpiar campos"><i class="fa fa-eraser"></i>&nbsp;&nbsp;Limpiar</button>
                        </dd>
                    </dl>
                </fieldset>
            </div> 
        </section>
  
    <section class="panel panel-default">
            <div class="panel-body">
	            <div style="float: right; margin-top: 10px;">
		                <button title="Enviar Reporte" class="btn btn-default" id="create_report"><i class="fa fa-download"></i><strong>Enviar Reporte</strong></button>
		                    <button title="Enviar Comprobantes" class="btn btn-info" id="download_cfdi_masive"><i class="fa fa-file-pdf-o"></i><strong>Enviar Comprobantes</strong></button>
		                    <button title="Enviar Comprobantes (lugar de pago)" class="btn btn-default" id="download_cfdi_masive_state"><i class="fa fa-file-pdf-o"></i><strong>Enviar Comprobantes (lugar de pago)</strong></button>
		                <button title="Enviar Comprobantes" class="btn btn-success" id="download_cfdi_masive_empleoyee"><i class="fa fa-file-pdf-o"></i><strong>Enviar Comprobantes (Empleados)</strong></button>
	                    <button title="Enviar PDF" class="btn btn-danger" id="download_cfdi_masive_pdf"><i class="fa fa-file-pdf-o"></i><strong>Enviar PDF</strong></button>
                    {% if user.role in "SA" %}
                    {% comment %}
                        <button title="Cancelar Comprobantes" class="btn btn-danger"><i class="fa fa-eraser"></i>&nbsp;<strong>Cancelar Comprobantes</strong></button>
                        {% endcomment %}
                {% endif %}
            </div>
        </div>
    </section>	
    
    <section class="panel panel-default">
      <header class="panel-heading">
        <div>
            Comprobantes:
        </div>
      </header>
      <div class="panel-body">
        <table class="table table-striped table-bordered nowrap" id="invoices_list" cellspacing="0" width="100%">
          <thead>
            <tr>
              <th>UUID</th>
              <th>Folio</th>
              <th>Fecha de emisi&oacute;n</th>
              <th>RFC Receptor</th>
              <th>Nombre Receptor</th>
              <th>Fecha Inicial Pago</th>
              <th>Fecha Final Pago</th>
              <th>Total</th>
              <th>Estatus</th>
              <th>Firma</th>
              <th>Opciones</th>
            </tr>
          </thead>
          <tfoot>
            <tr>
              <th>UUID</th>
              <th>Folio</th>
              <th>Fecha de emisi&oacute;n</th>
              <th>RFC Receptor</th>
              <th>Nombre Receptor</th>
              <th>Fecha Inicial Pago</th>
              <th>Fecha Final Pago</th>
              <th>Total</th>
              <th>Estatus</th>
              <th>Firma</th>
              <th>Opciones</th>
            </tr>
          </tfoot>
        </table>
      </div>
    </section>
  </div>
</div>
<!-- Small modal -->
<!--button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#gridSystemModal">Asignar Fecha</button-->


<div class="modal fade" id="detalles" tabindex="-1" role="dialog" aria-labelledby="exampledetallesModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h5 class="modal-title" id="exampleModalLabel">Enviar comprobantes por email</h5>
      </div>
      <div class="modal-body">
        <form id ="details_form">
            <div class="form-group">
              <label class="control-label">Correo electronico</label>
                <div style="text-align:left" class="input-group">
                <input type="email" id="id_email_destino" name="email_destino" class="form-control">
                <span class="input-group-btn">
                  <button id="btn_agregar_email" class="btn btn-default" type="button"><i class="fa fa-plus"></i> Agregar</button>
                </span>
                </div>
            </div>
          <div class="form-group" >
            <label for="message-text" class="form-control-label">Correos a enviar Compronates de nomina:</label>
            <div style="text-align:left" class="input-group">
             <input type="text" id="lista_correos" class="form-control" name="lista_correos" readonly>
             <span class="input-group-btn">
                  <button id="btn_clear_email" class="btn btn-info" type="button"><i class="fa fa-eraser"></i></button>
                </span>
              </div>
             <input type="text" id="uuid_oculto" class="form-control" readonly style="visibility:hidden;">
          </div>
        </form>
      </div>
      <div id="mf" class="modal-footer" style="visibility:hidden">
        <button type="button" class="btn btn-basic btn-sm" data-dismiss="modal"><i class="fa fa-close" aria-hidden="true"> Cancelar</i></button>
        <button type="button" class="btn btn-basic btn-sm" id="send"><i class="fa fa-envelope-o" aria-hidden="true"> Enviar email</i></button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="modal_eliminar" tabindex="-1" role="dialog" aria-labelledby="exampledetallesModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">Eliminar comprobante</h4>
      </div>
      <div class="modal-body">
      ¿Está seguro en eliminar? La información asociada al mismo también será eliminada.
                <div style="visibility:hidden" >
             <input type="text" id="uuidoculto">
          </div>
      </div>
      <div id="mf" class="modal-footer">
        <button data-dismiss="modal" class="btn btn-default btn-primary" type="button">Cancelar</button>
      <button id="btn_eliminar_comprobante" class="btn btn-rounded btn-danger" type="submit"><i class="fa fa-trash-o"></i> Eliminar</button>
      </div>
    </div>
  </div>
</div>

<div id="modal_cancellation" class="modal fade" role="dialog">
  <div class="modal-dialog modal-sm">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title header-modal">CANCELACIÓN DE CDFI</h4>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">¿Desear cancelar este CFDI: <strong id="strong_uuid" taxpayer_id=""></strong>?</label>
          </div>
          <div class="form-group">
            <label for="" class="col-form-label">Motivo de cancelación</label>
            <select id="cancel-motive" class="form-control">
                <option value="T" selected>Selecciona una opción</option>
                <option value="01">01 - Comprobante emitido con errores con relación.</option>
                <option value="02">02 - Comprobante emitido con errores sin relación.</option>
                <option value="03">03 - No se llevó a cabo la operación</option>
                <option value="04">04 - Operación nominativa relacionada en la factura global</option>
            </select>
          </div>
          <div class="form-group" id="cancel-folio-div" style="display: none;">
            <label for="" class="col-form-label">Folio Fiscal (UUID) que sustituye</label>
            <input type="text" id="cancel-folio" class="form-control">
          </div>
          <div class="form-group">
            <label for="notes" class="col-form-label">Notas</label>
            <textarea class="form-control" id="notes"></textarea>
            <input type="hidden" id="invoice_type_confirm" />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-primary send-can" title="Cancelar CFDI">Continuar</button>
      </div>
    </div>

  </div>
</div>


<div id="modal_signed" uuid="" class="modal fade" role="dialog">
  <div class="modal-dialog modal-sm">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title header-modal">FIRMADO DE NOMINA</h4>
      </div>
      <div id="sign" class="modal-body">
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Click en el recuadro para firmar</label>
          </div>
          <input type="text" id="txt" style="border-radius: 5px;">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-primary send-signed" title="Cancelar CFDI">Firmar</button>
      </div>
    </div>
  </div>
</div>

<div id="modal_qr" uuid="" class="modal fade" role="dialog">
  <div class="modal-dialog modal-sm">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 style="text-align: center;" class="modal-title header-modal">FIRMADO DE NOMINA</h4>
      </div>
      <div id="sign_qr" class="modal-body">
          <div style="text-align: center;">
              <img src="" alt="signsecure" id="signsecure">
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

{% include "modales/update_user_employee.html" %}

{% endblock %}

{% block jsfoot %}
    {% if user.role == "E" %}
        <script type="text/javascript">
          var DIFF_TIEMPO_RECHAZO = '{{ diff_tiempo_rechazo }}';
          var UID = '{{ user_id }}';
          if(DIFF_TIEMPO_RECHAZO == 'True'){
            $("#update_user_employee").modal('show')
          }
        </script>
        <script src="{% static 'js/core/admin/employee2.js' %}" type="text/javascript"></script>
    {% endif %}
{% endblock %}
